<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicializar Banco de Dados - Izicode Edu</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-900 text-white min-h-screen flex items-center justify-center p-8">
    <div class="max-w-2xl w-full">
        <div class="bg-slate-800 rounded-2xl p-8 border-2 border-purple-500">
            <h1 class="text-3xl font-bold mb-4">üîß Inicializa√ß√£o do Banco de Dados</h1>
            <p class="text-slate-300 mb-6">
                Este script ir√° popular o Firestore com dados iniciais:
            </p>
            <ul class="list-disc list-inside text-slate-300 mb-6 space-y-2">
                <li>15 badges de conquistas</li>
                <li>28 desafios p√∫blicos (da biblioteca)</li>
                <li>Materiais de aprendizagem (Arduino, Scratch)</li>
            </ul>

            <div class="bg-yellow-900/30 border border-yellow-500 rounded-xl p-4 mb-6">
                <p class="text-yellow-300 font-bold">‚ö†Ô∏è ATEN√á√ÉO:</p>
                <p class="text-yellow-200 text-sm">
                    Execute este script apenas UMA VEZ ap√≥s o primeiro deploy.
                    Executar m√∫ltiplas vezes criar√° dados duplicados.
                </p>
            </div>

            <button id="initButton"
                class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 px-6 rounded-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                üöÄ INICIALIZAR BANCO DE DADOS
            </button>

            <div id="console" class="mt-6 bg-slate-900 rounded-xl p-4 font-mono text-sm h-96 overflow-y-auto hidden">
                <div id="consoleOutput"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeDatabase } from './js/init-database.js';

        const button = document.getElementById('initButton');
        const consoleDiv = document.getElementById('console');
        const consoleOutput = document.getElementById('consoleOutput');

        // Interceptar console.log
        const originalLog = console.log;
        console.log = function (...args) {
            originalLog.apply(console, args);
            const message = args.join(' ');
            const line = document.createElement('div');
            line.textContent = message;

            // Colorir mensagens
            if (message.includes('‚úÖ')) {
                line.className = 'text-green-400';
            } else if (message.includes('‚ùå')) {
                line.className = 'text-red-400';
            } else if (message.includes('‚ö†Ô∏è')) {
                line.className = 'text-yellow-400';
            } else {
                line.className = 'text-slate-300';
            }

            consoleOutput.appendChild(line);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };

        button.addEventListener('click', async () => {
            button.disabled = true;
            button.textContent = '‚è≥ Inicializando...';
            consoleDiv.classList.remove('hidden');

            try {
                await initializeDatabase();
                button.textContent = '‚úÖ Inicializa√ß√£o Conclu√≠da!';
                button.className = 'w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white font-bold py-4 px-6 rounded-xl';
            } catch (error) {
                console.log('‚ùå Erro fatal:', error);
                button.textContent = '‚ùå Erro na Inicializa√ß√£o';
                button.className = 'w-full bg-gradient-to-r from-red-600 to-rose-600 text-white font-bold py-4 px-6 rounded-xl';
            }
        });
    </script>
</body>

</html>